<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Widget macro reference - GUI development with Relm4</title>
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="introduction.html">Introduction</a></li><li class="chapter-item expanded "><a href="first_app.html"><strong aria-hidden="true">1.</strong> Your first app</a></li><li class="chapter-item expanded "><a href="widget_macro.html"><strong aria-hidden="true">2.</strong> The widget macro</a></li><li class="chapter-item expanded "><a href="efficient_ui.html"><strong aria-hidden="true">3.</strong> Efficient UI updates</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="tracker.html"><strong aria-hidden="true">3.1.</strong> Tracker</a></li><li class="chapter-item expanded "><a href="factory.html"><strong aria-hidden="true">3.2.</strong> Factories</a></li><li class="chapter-item expanded "><a href="factory_advanced.html"><strong aria-hidden="true">3.3.</strong> Advanced factories</a></li></ol></li><li class="chapter-item expanded "><a href="components.html"><strong aria-hidden="true">4.</strong> Components</a></li><li class="chapter-item expanded "><a href="worker.html"><strong aria-hidden="true">5.</strong> Workers</a></li><li class="chapter-item expanded "><a href="threads_and_async.html"><strong aria-hidden="true">6.</strong> Threads and async</a></li><li class="chapter-item expanded "><a href="reusable_components.html"><strong aria-hidden="true">7.</strong> Reusable components</a></li><li class="chapter-item expanded "><a href="widget_macro_reference.html" class="active"><strong aria-hidden="true">8.</strong> Widget macro reference</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="widget_macro_expansion.html"><strong aria-hidden="true">8.1.</strong> Macro expansion</a></li></ol></li><li class="chapter-item expanded "><a href="templates.html"><strong aria-hidden="true">9.</strong> Templates</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="app_template.html"><strong aria-hidden="true">9.1.</strong> App template</a></li><li class="chapter-item expanded "><a href="component_template.html"><strong aria-hidden="true">9.2.</strong> Component template</a></li><li class="chapter-item expanded "><a href="worker_template.html"><strong aria-hidden="true">9.3.</strong> Worker template</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">GUI development with Relm4</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/AaronErhardt/AaronErhardt.github.io/tree/master/relm4-book" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="the-widget-macro-reference"><a class="header" href="#the-widget-macro-reference">The widget macro reference</a></h1>
<p>There are quite a lot of examples where the widget macro is used in this book. Yet, we haven't covered everything in the previous chapters and having all the information in one place is nice, too.</p>
<h2 id="property-names"><a class="header" href="#property-names">Property names</a></h2>
<p>The widget macros uses setter methods of gtk4-rs. You can find them at the <a href="https://gtk-rs.org/gtk4-rs/git/docs/gtk4/index.html">gtk4-rs docs</a>.</p>
<p>Many properties are also part of a trait. Make sure that this trait is in scope. In many cases you need to <code>use gtk::prelude::TraitName</code>.</p>
<p>For example, if you want to use the <a href="https://gtk-rs.org/gtk4-rs/git/docs/gtk4/prelude/trait.GtkWindowExt.html#tymethod.set_default_width"><code>set_default_width</code></a> method of the <code>GtkWindowExt</code> trait you need to <code>use gtk::prelude::GtkWindowExt</code>.</p>
<h3 id="trait-disambiguation"><a class="header" href="#trait-disambiguation">Trait disambiguation</a></h3>
<p>Sometimes you use several traits that implement the same method for a type so you need to tell Rust which trait it should use. For example the <code>set_child</code> function is implemented by both <code>gtk::prelude::GtkWindowExt</code> and <code>libadwaita::traits::ApplicationWindowExt</code>. If we use the regular syntax, the Rust compiler will get confused and tells us to specify the trait. So instead we use the <code>TraitName::method</code> syntax that's similar to <a href="https://doc.rust-lang.org/book/ch19-03-advanced-traits.html#fully-qualified-syntax-for-disambiguation-calling-methods-with-the-same-name">Rust's fully qualified syntax for trait disambiguation</a>.</p>
<pre><code class="language-rust no_run noplayground"><span class="boring">use libadwaita::traits::ApplicationWindowExt;
</span>ApplicationWindowExt::set_child = Some(&amp;gtk::Box) { ... }
</code></pre>
<p>You can also use the full path of the trait.</p>
<pre><code class="language-rust no_run noplayground">libadwaita::traits::ApplicationWindowExt::set_child = Some(&amp;gtk::Box) { ... }
</code></pre>
<h2 id="public-widgets"><a class="header" href="#public-widgets">Public widgets</a></h2>
<p>If you want to make the widgets struct generated by the macro public, you can simply use <code>pub</code> as an attribute for the macro.</p>
<pre><code class="language-rust no_run noplayground">#[relm4_macros::widget(pub)]
</code></pre>
<h2 id="assign-properties"><a class="header" href="#assign-properties">Assign properties</a></h2>
<p>Initialize a property with a value:</p>
<pre><code class="language-rust no_run noplayground">property_name: value,
</code></pre>
<p>Initialize an optional property only if it's <code>Some</code> and ignore if it's none:</p>
<pre><code class="language-rust no_run noplayground">property_name?: value,
</code></pre>
<p>Initialize a property that has multiple properties:</p>
<pre><code class="language-rust no_run noplayground">property_name: args!(value1, value2, ...),
</code></pre>
<p>Initialize and automatically update a property:</p>
<pre><code class="language-rust no_run noplayground">property_name: watch!(value1, value2, ...),
</code></pre>
<p>Initialize and automatically update a property with a tracker. The track_expression can be any expression that returns a bool. If it's true, it indicates, that the property should be updated:</p>
<pre><code class="language-rust no_run noplayground">property_name: track!(track_expression, value1, value2, ...),
</code></pre>
<p>Initialize a property by iterating over an iterator. You can use this for repeated calls to setter functions, like <code>add_class_name</code> in case you have multiple class names in a <code>Vec</code>.</p>
<pre><code class="language-rust no_run noplayground">property_name: iterate!(iterator),
</code></pre>
<h2 id="add-widgets"><a class="header" href="#add-widgets">Add widgets</a></h2>
<p>Without name:</p>
<pre><code class="language-rust no_run noplayground">property_name = gtk::Box { ... }
</code></pre>
<blockquote>
<p>A common mistake is to accidentally use <code>:</code> instead of <code>=</code> for assigning widgets.</p>
</blockquote>
<p>With name:</p>
<pre><code class="language-rust no_run noplayground">property_name: name = gtk::Box { ... }
</code></pre>
<p>As reference:</p>
<pre><code class="language-rust no_run noplayground">property_name = &amp;gtk::Box { ... }
</code></pre>
<p>As <code>Option</code>:</p>
<pre><code class="language-rust no_run noplayground">property_name = Some(gtk::Box) { ... }
</code></pre>
<p>As reference in an <code>Option</code>:</p>
<pre><code class="language-rust no_run noplayground">property_name = Some(&amp;gtk::Box) { ... }
</code></pre>
<p>The type of the widget created in all the examples above will always be <code>gtk::Box</code>. However, some properties are set with references or references in <code>Options</code> where this syntax becomes handy.</p>
<h3 id="functions"><a class="header" href="#functions">Functions</a></h3>
<p>Sometimes there's no default implementation for a widget, so you need a constructor or you want to pass a function that returns the widget.</p>
<p>If the function is associated with a type, you can simply use this syntax. The macro will assume the type of <code>gtk::Box::new()</code> is <code>gtk::Box</code>:</p>
<pre><code class="language-rust no_run noplayground">property_name = gtk::Box::new() { ... }
</code></pre>
<p>For some functions, the macro can't guess the type or might even assume a wrong type. In such a case, add the type your function:</p>
<pre><code class="language-rust no_run noplayground">property_name = new_box() -&gt; gtk::Box { ... }
</code></pre>
<h2 id="factories"><a class="header" href="#factories">Factories</a></h2>
<pre><code class="language-rust no_run noplayground">property_name = gtk::Box { 
    factory!(model.data)
}
</code></pre>
<h2 id="manual"><a class="header" href="#manual">Manual</a></h2>
<p>Sometimes the macro isn't flexible enough. In this case, you can always use manual code that will not be modified by the macro.</p>
<p>Here's a list of all the options available.</p>
<pre><code class="language-rust no_run noplayground">#[relm4_macros::widget]
impl Widgets&lt;AppModel, ()&gt; for AppWidgets {
    view! {
        // ...
    }

    additional_fields! {
        // ...
    }

    fn pre_init() {
        // ...
    }

    fn post_init() {
        // ...
    }

    fn manual_view() {
        // ...
    }
}
</code></pre>
<h3 id="run-custom-initialization-code"><a class="header" href="#run-custom-initialization-code">Run custom initialization code</a></h3>
<p>You can use the <code>pre_init</code> function inside the widgets macro to run code before the initialization of the view macro starts. This is useful if you want to generate values you later use in the view macro.</p>
<pre><code class="language-rust no_run noplayground">fn pre_init() {
    // ...
}
</code></pre>
<p>You can use the <code>post_init</code> function to run code after the initialization of the view macro. This can be used to modify the widgets generated by the view macro for manual initialization. All variables and widget names used in the view macro and the <code>pre_init</code> function can still be used here.</p>
<pre><code class="language-rust no_run noplayground">fn post_init() {
    // ...
}
</code></pre>
<h3 id="add-more-fields-to-your-widgets"><a class="header" href="#add-more-fields-to-your-widgets">Add more fields to your widgets</a></h3>
<p>The widgets struct is automatically generated by the macro, but sometimes you want to add your own fields. To do so, use the <code>additional_fields!</code> macro:</p>
<pre><code class="language-rust no_run noplayground">additional_fields! {
    test: u8,
}
</code></pre>
<p>To initialize the variable, you can use either <code>pre_init</code> or <code>post_init</code>. Simply name a local variable like your custom field. I this case we could simply do this:</p>
<pre><code class="language-rust no_run noplayground">fn post_init() {
    let test = 0;
}
</code></pre>
<p>The macro will then put all parts together to create the widgets struct and the <code>init_view</code> function.</p>
<pre><code class="language-rust no_run noplayground">struct AppWidgets {
    ...
    test: u8,
}

impl Widgets&lt;AppModel, ()&gt; for AppWidgets {
    ...
    fn init_view(model: &amp;AppModel, parent_widgets: &amp;(), sender: Sender&lt;AppMsg&gt;) -&gt; Self {
        ...
        let test = 0;
        AppWidgets {
            ...
            test,
        }
    }
    ...
}
</code></pre>
<h3 id="manual-view"><a class="header" href="#manual-view">Manual view</a></h3>
<p>You can also implement your own view logic that's added to the view code the view macro generates. To refer to the widgets, use <code>self</code> and <code>model</code> for the model.</p>
<pre><code class="language-rust no_run noplayground">fn manual_view() {
    // ...
}
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="reusable_components.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                            <a rel="next" href="widget_macro_expansion.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="reusable_components.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                    <a rel="next" href="widget_macro_expansion.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
    </body>
</html>
